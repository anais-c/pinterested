{"filter":false,"title":"application_controller.rb","tooltip":"~/depot/app/controllers/application_controller.rb","undoManager":{"stack":[[{"start":{"row":0,"column":52},"end":{"row":1,"column":0},"action":"insert","lines":["",""],"id":2},{"start":{"row":1,"column":0},"end":{"row":1,"column":2},"action":"insert","lines":["  "]}],[{"start":{"row":1,"column":2},"end":{"row":1,"column":46},"action":"insert","lines":["  before_action :set_i18n_locale_from_params"],"id":3}],[{"start":{"row":1,"column":2},"end":{"row":1,"column":4},"action":"remove","lines":["  "],"id":4}],[{"start":{"row":10,"column":0},"end":{"row":14,"column":9},"action":"remove","lines":["    def authorize","      unless User.find_by(id: session[:user_id])","        redirect_to login_url, notice: \"Please log in\"","      end","    end  "],"id":5},{"start":{"row":10,"column":0},"end":{"row":37,"column":7},"action":"insert","lines":["    def authorize","      if request.format == Mime::HTML ","        unless User.find_by(id: session[:user_id])","          redirect_to login_url, notice: \"Please log in\"","        end","      else","        authenticate_or_request_with_http_basic do |username, password|","          user = User.find_by(name: username)","          user && user.authenticate(password)","        end","      end","    end","","    def set_i18n_locale_from_params","      if params[:locale]","        if I18n.available_locales.map(&:to_s).include?(params[:locale])","          I18n.locale = params[:locale]","        else","          flash.now[:notice] = ","            \"#{params[:locale]} translation not available\"","          logger.error flash.now[:notice]","        end","      end","    end","","    def default_url_options","      { locale: I18n.locale }","    end"]}]],"mark":3,"position":3},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":37,"column":7},"end":{"row":37,"column":7},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1431085450785,"hash":"cd8c9927017607b705c845982827a0c767ef8da9"}